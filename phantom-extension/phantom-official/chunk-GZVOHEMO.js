import{Ab as st,Ec as ie,Ka as Zt,gb as wt,kb as Q,ob as te,pb as ee,qb as oe,rb as re,tb as Pt,ub as ae,vd as se}from"./chunk-U6X5ZLHM.js";import{ja as ne}from"./chunk-7X5IGQSF.js";import{$a as Yt,J as O,K as Y,L as u,Za as W,ab as At,c as Ye,pc as $t,r as Bt,se as Xt}from"./chunk-M4V43KDP.js";import{x as Ht}from"./chunk-HG4P4WCJ.js";import{r as nt,t as Qt,w as it,z as ht}from"./chunk-VU23O6LP.js";import{c as at}from"./chunk-RFTHTXRF.js";import{U as Gt,V as Jt,W as bt,u as J}from"./chunk-YTFWYDJ6.js";import{a as Ut,d as gt,e as $,f as U,g as zt,h as jt,i as y}from"./chunk-O2FNG2JZ.js";import{c as Ge,f as M,h as i,l as Je,m as Buffer,n as s}from"./chunk-3KENBVE7.js";var Le=Ge(l=>{"use strict";i();s();var Oo=l&&l.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(l,"__esModule",{value:!0});l.map=l.array=l.rustEnum=l.str=l.vecU8=l.tagged=l.vec=l.bool=l.option=l.publicKey=l.i256=l.u256=l.i128=l.u128=l.i64=l.u64=l.struct=l.f64=l.f32=l.i32=l.u32=l.i16=l.u16=l.i8=l.u8=void 0;var w=wt(),Vo=Bt(),Ro=Oo(at()),q=wt();Object.defineProperty(l,"u8",{enumerable:!0,get:function(){return q.u8}});Object.defineProperty(l,"i8",{enumerable:!0,get:function(){return q.s8}});Object.defineProperty(l,"u16",{enumerable:!0,get:function(){return q.u16}});Object.defineProperty(l,"i16",{enumerable:!0,get:function(){return q.s16}});Object.defineProperty(l,"u32",{enumerable:!0,get:function(){return q.u32}});Object.defineProperty(l,"i32",{enumerable:!0,get:function(){return q.s32}});Object.defineProperty(l,"f32",{enumerable:!0,get:function(){return q.f32}});Object.defineProperty(l,"f64",{enumerable:!0,get:function(){return q.f64}});Object.defineProperty(l,"struct",{enumerable:!0,get:function(){return q.struct}});var z=class extends w.Layout{constructor(e,o,r){super(e,r),this.blob=(0,w.blob)(e),this.signed=o}decode(e,o=0){let r=new Ro.default(this.blob.decode(e,o),10,"le");return this.signed?r.fromTwos(this.span*8).clone():r}encode(e,o,r=0){return this.signed&&(e=e.toTwos(this.span*8)),this.blob.encode(e.toArrayLike(Buffer,"le",this.span),o,r)}};function Ie(t){return new z(8,!1,t)}l.u64=Ie;function Do(t){return new z(8,!0,t)}l.i64=Do;function Co(t){return new z(16,!1,t)}l.u128=Co;function Mo(t){return new z(16,!0,t)}l.i128=Mo;function Wo(t){return new z(32,!1,t)}l.u256=Wo;function Fo(t){return new z(32,!0,t)}l.i256=Fo;var F=class extends w.Layout{constructor(e,o,r,a){super(e.span,a),this.layout=e,this.decoder=o,this.encoder=r}decode(e,o){return this.decoder(this.layout.decode(e,o))}encode(e,o,r){return this.layout.encode(this.encoder(e),o,r)}getSpan(e,o){return this.layout.getSpan(e,o)}};function qo(t){return new F((0,w.blob)(32),e=>new Vo.PublicKey(e),e=>e.toBuffer(),t)}l.publicKey=qo;var Dt=class extends w.Layout{constructor(e,o){super(-1,o),this.layout=e,this.discriminator=(0,w.u8)()}encode(e,o,r=0){return e==null?this.discriminator.encode(0,o,r):(this.discriminator.encode(1,o,r),this.layout.encode(e,o,r+1)+1)}decode(e,o=0){let r=this.discriminator.decode(e,o);if(r===0)return null;if(r===1)return this.layout.decode(e,o+1);throw new Error("Invalid option "+this.property)}getSpan(e,o=0){let r=this.discriminator.decode(e,o);if(r===0)return 1;if(r===1)return this.layout.getSpan(e,o+1)+1;throw new Error("Invalid option "+this.property)}};function Bo(t,e){return new Dt(t,e)}l.option=Bo;function Uo(t){return new F((0,w.u8)(),zo,jo,t)}l.bool=Uo;function zo(t){if(t===0)return!1;if(t===1)return!0;throw new Error("Invalid bool: "+t)}function jo(t){return t?1:0}function Go(t,e){let o=(0,w.u32)("length"),r=(0,w.struct)([o,(0,w.seq)(t,(0,w.offset)(o,-o.span),"values")]);return new F(r,({values:a})=>a,a=>({values:a}),e)}l.vec=Go;function Jo(t,e,o){let r=(0,w.struct)([Ie("tag"),e.replicate("data")]);function a({tag:n,data:m}){if(!n.eq(t))throw new Error("Invalid tag, expected: "+t.toString("hex")+", got: "+n.toString("hex"));return m}return new F(r,a,n=>({tag:t,data:n}),o)}l.tagged=Jo;function xe(t){let e=(0,w.u32)("length"),o=(0,w.struct)([e,(0,w.blob)((0,w.offset)(e,-e.span),"data")]);return new F(o,({data:r})=>r,r=>({data:r}),t)}l.vecU8=xe;function Yo(t){return new F(xe(),e=>e.toString("utf-8"),e=>Buffer.from(e,"utf-8"),t)}l.str=Yo;function Qo(t,e,o){let r=(0,w.union)(o??(0,w.u8)(),e);return t.forEach((a,n)=>r.addVariant(n,a,a.property)),r}l.rustEnum=Qo;function $o(t,e,o){let r=(0,w.struct)([(0,w.seq)(t,e,"values")]);return new F(r,({values:a})=>a,a=>({values:a}),o)}l.array=$o;var Ct=class extends w.Layout{constructor(e,o,r){super(e.span+o.span,r),this.keyLayout=e,this.valueLayout=o}decode(e,o){o=o||0;let r=this.keyLayout.decode(e,o),a=this.valueLayout.decode(e,o+this.keyLayout.getSpan(e,o));return[r,a]}encode(e,o,r){r=r||0;let a=this.keyLayout.encode(e[0],o,r),n=this.valueLayout.encode(e[1],o,r+a);return a+n}getSpan(e,o){return this.keyLayout.getSpan(e,o)+this.valueLayout.getSpan(e,o)}};function Ho(t,e,o){let r=(0,w.u32)("length"),a=(0,w.struct)([r,(0,w.seq)(new Ct(t,e),(0,w.offset)(r,-r.span),"values")]);return new F(a,({values:n})=>new Map(n),n=>({values:Array.from(n.entries())}),o)}l.map=Ho});i();s();i();s();var ct=M(Ye(),1);var ue=M(Bt(),1);var ce=(0,ct.struct)([(0,ct.u8)("instruction"),te("amount")]);function le(t,e,o,r,a=[],n=Q){let m=re([{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e,isSigner:!1,isWritable:!1}],o,a),d=Buffer.alloc(ce.span);return ce.encode({instruction:ee.Approve,amount:BigInt(r)},d),new ue.TransactionInstruction({keys:m,programId:n,data:d})}var de=new u.PublicKey("Config1111111111111111111111111111111111111"),Qe="https://docs.solana.com/staking",$e="https://docs.solana.com/implemented-proposals/staking-rewards",He={type:"SolanaNative",data:{amount:"0",balance:new Jt(0),chain:{id:W.solana.mainnetID,imageUrl:W.solana.iconUrl,name:W.solana.name,symbol:W.solana.tokenSymbol},decimals:9,key:"SolanaNative",logoUri:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",name:"Solana",symbol:"SOL",tokenAddress:void 0,walletAddress:"",spamStatus:"NOT_VERIFIED"}},wr=new Map([[Yt.Solana.Mainnet,He]]),Xe="https://www.jito.network/blog/lsts-vs-native-assets/",Ze="https://www.jito.network/staking/?mode=unstake",to="https://help.phantom.com/hc/en-us/articles/29846774040467",eo="https://www.jito.network/blog/reward-bearing-vs-rebasing-solana-liquid-staking-tokens/",oo="https://www.jito.network/interceptor";var ro="solana:101/address:J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn",Pr=4e6,Tr=2282880;i();s();function pe(t,e){let o=new bt(t/100),r=new bt(e/100);return o.minus(o.times(r)).times(100).decimalPlaces(2).toNumber()}i();s();i();s();i();s();var x="staking";var Tt=[x,"stakeAccounts"],vt=[x,"stakeActivationData"],It=[x,"convertStakeAccountList"],xt=[x,"convertStakeTransaction"],Lt=[x,"mintTokenTransaction"],Et="averageValidatorApy",ao="recommendedValidators",no="signatureStatus",io="stakeAccountMinBalance",so="stakeRewardsHistory",co="stakeApy",uo="validatorInfo",lo="voteAccounts",po="keybaseUserAvatar",ut={keybaseUserAvatar(t){return[x,po,t]},signatureStatus(t){return[x,no,t]},stakeAccounts(t,e){return[...Tt,t,e]},stakeAccountMinBalance(){return[x,io]},stakeActivationData(t){return[...vt,t]},stakeRewardsHistory(t){return[x,so,t]},stakeApy(){return[x,co]},averageValidatorApy(){return[x,Et]},recommendedValidators(){return[x,ao]},validatorInfo(){return[x,uo]},voteAccounts(t){return[x,lo,t]},convertStakeAccountList(t,e){return[...It,t,e]},liquidStakingSupportedTokens(){return[x,"liquidStakingSupportedTokens"]},getConvertStakeTransaction(t){return[...xt,t]},getMintTokenTransaction(t){return[...Lt,t]},featureUsed(){return[x,"featureUsed"]}};var H=t=>()=>{t.invalidateQueries({predicate:e=>{let o=r=>r.every((a,n)=>e.queryKey[n]===a);return o(Tt)||o(vt)||o(It)||o(xt)||o(Lt)}})};i();s();function me(t,e=9){return t.match(new RegExp(`^\\d*(\\.\\d{0,${e}})?$`))}i();s();var ye={type:"fungible",isNativeOfType:"sol",chain:"solana",name:"Solana",symbol:"SOL",iconUrl:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",decimals:9},yo="stake",Se=t=>new _t(t,yo),_t=class extends ne{createStakeAccountAndDelegateStake=e=>{this.analytics.capture("createStakeAccountAndDelegateStake",{data:{...e,...ye}})};deactivateStake=()=>{this.analytics.capture("deactivateStake",{data:{...ye}})}};var Kt=Gt($t,t=>Se(t));i();s();var lt=M(Ut());i();s();var ke=(t,e)=>t+e[1];function ge(t){let e=So(t),o={commissionWeight:.6,epochCreditsWeight:.1,activatedStakeWeight:.3},r=ko(e.maxEpochCredits,e.maxActivatedStake,o);return t.sort(r)}function So(t){let e={maxEpochCredits:0,maxActivatedStake:0};for(let o of t){let r=o.epochCredits.reduce(ke,0);e.maxEpochCredits<r&&(e.maxEpochCredits=r),e.maxActivatedStake<o.activatedStake&&(e.maxActivatedStake=o.activatedStake)}return e}function fo(t,e,o,r,a){let n=(100-t)/100,m=e/o,d=Math.log10(r+1)/Math.log10(a+1);return{normalizedCommission:n,normalizedEpochCredits:m,normalizedActivatedStake:d}}function fe(t,e,o,r){let{commission:a,epochCredits:n,activatedStake:m}=t,{commissionWeight:d,epochCreditsWeight:A,activatedStakeWeight:S}=r,{normalizedCommission:p,normalizedEpochCredits:h,normalizedActivatedStake:b}=fo(a,n.reduce(ke,0),e,m,o);return(a>10?.5:1)*(d*p+A*h+S*b)}function ko(t,e,o){return(r,a)=>{let n=fe(r,t,e,o);return fe(a,t,e,o)-n}}i();s();i();s();var go=(a=>(a[a.Always=1/0]="Always",a[a.Short=J({days:1})]="Short",a[a.Medium=J({days:3})]="Medium",a[a.Long=J({days:7})]="Long",a))(go||{}),Nt=(n=>(n[n.Immediate=0]="Immediate",n[n.Short=J({minutes:1})]="Short",n[n.Medium=J({minutes:2.5})]="Medium",n[n.Long=J({minutes:5})]="Long",n[n.Never=1/0]="Never",n))(Nt||{});var bo=t=>async()=>(await t.getParsedProgramAccounts(de)).reduce((o,r)=>{if(r.account.data.parsed?.type!=="validatorInfo")return o;let a=r.pubkey.toString(),n=r.account.data.parsed.info.keys,[,m]=n;if(!m.signer)return o;let d=m.pubkey,A=r.account.data.parsed.info.configData;return o.push({identityPubkey:d,infoPubkey:a,info:A}),o},[]);function be(t){let e=ut.validatorInfo(),o=bo(t);return it({queryKey:e,queryFn:o,placeholderData:[],staleTime:1/0})}i();s();var Ao=async t=>{let e=await t.getVoteAccounts();return[...e.current,...e.delinquent].map(o=>({identityPubkey:o.nodePubkey,voteAccountPubkey:o.votePubkey,commission:o.commission,lastVote:o.lastVote,epochCredits:o.epochCredits,activatedStake:o.activatedStake})).filter(o=>o.commission<99)};function Ae(t){let e=ut.voteAccounts(t.rpcEndpoint);return it({queryKey:e,queryFn:async()=>Ao(t),placeholderData:[],staleTime:1/0})}function ho(t){let{isFetched:e,isFetching:o,isPending:r,isSuccess:a,isError:n,dataUpdatedAt:m,errorUpdatedAt:d,error:A,refetch:S,data:p}=Ae(t),h=Math.max(m,d),{isFetched:b,isFetching:v,isPending:f,isSuccess:P,isError:I,dataUpdatedAt:T,errorUpdatedAt:L,error:E,refetch:_,data:N}=be(t),g=Math.max(T,L),V=Math.max(h,g),B=e&&b,D=o||v,C=a||P,ot=n||I,rt=A||E,We=r||f,Fe=(0,lt.useCallback)(async()=>{Promise.all([S(),_()])},[_,S]);return{results:(0,lt.useMemo)(()=>{if(!p)return[];if(!N)return[];let qe=ge(p),Be=new Map(qe.map(G=>[G.identityPubkey,G])),Ue=new Map(N.map(G=>[G.identityPubkey,G])),qt=[];for(let[G,ze]of Be){let je=Ue.get(G);qt.push({...ze,...je})}return qt},[N,p]),dataUpdatedAt:V,error:rt,isSuccess:C,isError:ot,isFetched:B,isFetching:D,isPending:We,refetch:Fe}}i();s();function Ot(t){let e=!!t?.info.meta.lockup,o=new Date((t?.info.meta.lockup?.unixTimestamp??0)*1e3);return e&&o.getTime()>Date.now()}i();s();i();s();var wo=y.object({apy:y.number()}),Po=y.object({validators:y.array(y.string())}),he=y.object({epoch:y.number(),effectiveSlot:y.number(),amount:y.number(),postBalance:y.number(),percentChange:y.number(),apr:y.number(),timestamp:y.number()}),To=y.object({items:y.array(he)}),vo=y.object({address:y.string(),chainId:At,decimals:y.number(),logoURI:y.string(),name:y.string(),symbol:y.string()}),Io=y.object({caip19:y.string(),metadata:vo}),xo=y.object({vote_account:y.string()}),Lo=y.object({apy:y.string(),chainId:At,convertRatio:y.string(),name:y.string(),stakePoolAddress:y.string(),stakePoolTokenMetadata:Io,validators:y.array(xo)}),Na=y.record(y.string(),y.array(Lo));i();s();i();s();var we={transactionData:void 0,fungibleToStake:void 0,provider:void 0,convert:{validatorVote:"",stakeAccount:"",validatorName:"",eligibleAccountsCount:0},amount:"",navigateTo:null,skipDismissRouting:void 0},Pe=Xt(t=>({...we,resetStaking:()=>t(we),setTransactionData:e=>t({transactionData:e}),setFungibleToStake:e=>t({fungibleToStake:e}),setProvider:e=>t({provider:e}),setConvertStakeAccount:e=>t({convert:e}),setAmount:e=>t({amount:e}),setNavigateTo:e=>t({navigateTo:e}),setSkipDismissRouting:e=>t({skipDismissRouting:e})}));i();s();var Eo=["liquidStakingSupportedTokens","featureUsed",Et],_o=t=>{let e=String(t.queryKey[1]);return Eo.includes(e)};i();s();var No=(t,e)=>{if(t.type==="initialized")return!1;let o=t?.info?.stake?.delegation?.voter??"",r=Ot(t);return t.activationState==="active"&&e.has(o)&&!r};i();s();i();s();var Te=M(Ut());var rn=()=>{let t=nt();return(0,Te.useCallback)(()=>H(t)(),[t])},Vt=(t,e,o)=>st({connection:t,signature:e,commitment:"finalized"}).then(()=>{H(o)()});i();s();var et=M(at());i();s();var Rt=M(Je());var un=new u.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s");var K=new u.PublicKey("SPoo1Ku8WFXoNDMHPsrGSTSG1Y47rzgn41SLUNakuHy");var ln=Rt.Buffer.from("ephemeral"),ve=Rt.Buffer.from("transient"),X=u.LAMPORTS_PER_SOL;i();s();var dt=Object.freeze({DepositStake:{index:9,layout:O.struct([O.u8("instruction")])},DepositSol:{index:14,layout:O.struct([O.u8("instruction"),O.ns64("lamports")])},WithdrawStake:{index:10,layout:O.struct([O.u8("instruction"),O.ns64("poolTokens")])},WithdrawSol:{index:16,layout:O.struct([O.u8("instruction"),O.ns64("poolTokens")])}});function pt(t,e){let o=t.layout.span,r=Buffer.alloc(o),a=Object.assign({instruction:t.index},e);return t.layout.encode(a,r),r}var Z=class{static depositStake(e){let{stakePool:o,validatorList:r,depositAuthority:a,withdrawAuthority:n,depositStake:m,validatorStake:d,reserveStake:A,destinationPoolAccount:S,managerFeeAccount:p,referralPoolAccount:h,poolMint:b,referralAccount:v}=e,f=dt.DepositStake,P=pt(f),I=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:S,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:u.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:u.SYSVAR_STAKE_HISTORY_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:Q,isSigner:!1,isWritable:!1},{pubkey:u.StakeProgram.programId,isSigner:!1,isWritable:!1}];return v&&I.push({pubkey:v,isSigner:!1,isWritable:!1}),new Y.TransactionInstruction({programId:K,keys:I,data:P})}static depositSol(e){let{stakePool:o,withdrawAuthority:r,depositAuthority:a,reserveStake:n,fundingAccount:m,destinationPoolAccount:d,managerFeeAccount:A,referralPoolAccount:S,poolMint:p,lamports:h,referralAccount:b}=e,v=dt.DepositSol,f=pt(v,{lamports:h}),P=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!0,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:S,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:u.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Q,isSigner:!1,isWritable:!1}];return a&&P.push({pubkey:a,isSigner:!0,isWritable:!1}),b&&P.push({pubkey:b,isSigner:!1,isWritable:!1}),new Y.TransactionInstruction({programId:K,keys:P,data:f})}static withdrawStake(e){let{stakePool:o,validatorList:r,withdrawAuthority:a,validatorStake:n,destinationStake:m,destinationStakeAuthority:d,sourceTransferAuthority:A,sourcePoolAccount:S,managerFeeAccount:p,poolMint:h,poolTokens:b}=e,v=dt.WithdrawStake,f=pt(v,{poolTokens:b}),P=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!0,isWritable:!1},{pubkey:S,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:u.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:Q,isSigner:!1,isWritable:!1},{pubkey:u.StakeProgram.programId,isSigner:!1,isWritable:!1}];return new Y.TransactionInstruction({programId:K,keys:P,data:f})}static withdrawSol(e){let{stakePool:o,withdrawAuthority:r,sourceTransferAuthority:a,sourcePoolAccount:n,reserveStake:m,destinationSystemAccount:d,managerFeeAccount:A,solWithdrawAuthority:S,poolMint:p,poolTokens:h}=e,b=dt.WithdrawSol,v=pt(b,{poolTokens:h}),f=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:u.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:u.SYSVAR_STAKE_HISTORY_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:u.StakeProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Q,isSigner:!1,isWritable:!1}];return S&&f.push({pubkey:S,isSigner:!0,isWritable:!1}),new Y.TransactionInstruction({programId:K,keys:f,data:v})}};i();s();var c=M(Le());var Ee=M(at()),_e=M(wt());var j=[(0,c.u64)("denominator"),(0,c.u64)("numerator")];var mt=gt().transform(t=>new Ee.default(t,10)),yt=gt().transform(t=>new u.PublicKey(t)),Xo=zt(["uninitialized","initialized","delegated","rewardsPool"]),Zo=U({rentExemptReserve:mt,authorized:U({staker:yt,withdrawer:yt}),lockup:U({unixTimestamp:$(),epoch:$(),custodian:yt})}),tr=U({meta:Zo,stake:U({delegation:U({voter:yt,stake:mt,activationEpoch:mt,deactivationEpoch:mt,warmupCooldownRate:$()}),creditsObserved:$()}).nullish().default(null)}),Ke=U({type:Xo,info:jt(tr)}),Wt=class extends _e.Layout{layout;discriminator;constructor(e,o){super(-1,o),this.layout=e,this.discriminator=(0,c.u8)()}encode(e,o,r=0){return e==null?this.discriminator.encode(0,o,r):(this.discriminator.encode(2,o,r),this.layout.encode(e,o,r+1)+1)}decode(e,o=0){let r=this.discriminator.decode(e,o);if(r===0)return null;if(r===1||r===2)return this.layout.decode(e,o+1);throw new Error("Invalid future epoch "+this.property)}getSpan(e,o=0){let r=this.discriminator.decode(e,o);if(r===0)return 1;if(r===1||r===2)return this.layout.getSpan(e,o+1)+1;throw new Error("Invalid future epoch "+this.property)}};function Mt(t,e){return new Wt(t,e)}var Ne=(0,c.struct)([(0,c.u8)("accountType"),(0,c.publicKey)("manager"),(0,c.publicKey)("staker"),(0,c.publicKey)("stakeDepositAuthority"),(0,c.u8)("stakeWithdrawBumpSeed"),(0,c.publicKey)("validatorList"),(0,c.publicKey)("reserveStake"),(0,c.publicKey)("poolMint"),(0,c.publicKey)("managerFeeAccount"),(0,c.publicKey)("tokenProgramId"),(0,c.u64)("totalLamports"),(0,c.u64)("poolTokenSupply"),(0,c.u64)("lastUpdateEpoch"),(0,c.struct)([(0,c.u64)("unixTimestamp"),(0,c.u64)("epoch"),(0,c.publicKey)("custodian")],"lockup"),(0,c.struct)(j,"epochFee"),Mt((0,c.struct)(j),"nextEpochFee"),(0,c.option)((0,c.publicKey)(),"preferredDepositValidatorVoteAddress"),(0,c.option)((0,c.publicKey)(),"preferredWithdrawValidatorVoteAddress"),(0,c.struct)(j,"stakeDepositFee"),(0,c.struct)(j,"stakeWithdrawalFee"),Mt((0,c.struct)(j),"nextStakeWithdrawalFee"),(0,c.u8)("stakeReferralFee"),(0,c.option)((0,c.publicKey)(),"solDepositAuthority"),(0,c.struct)(j,"solDepositFee"),(0,c.u8)("solReferralFee"),(0,c.option)((0,c.publicKey)(),"solWithdrawAuthority"),(0,c.struct)(j,"solWithdrawalFee"),Mt((0,c.struct)(j),"nextSolWithdrawalFee"),(0,c.u64)("lastEpochPoolTokenSupply"),(0,c.u64)("lastEpochTotalLamports")]);var er=(0,c.struct)([(0,c.u64)("activeStakeLamports"),(0,c.u64)("transientStakeLamports"),(0,c.u64)("lastUpdateEpoch"),(0,c.u64)("transientSeedSuffixStart"),(0,c.u64)("transientSeedSuffixEnd"),(0,c.u8)("status"),(0,c.publicKey)("voteAccountAddress")]),St=(0,c.struct)([(0,c.u8)("accountType"),(0,c.u32)("maxValidators"),(0,c.vec)(er,"validators")]);i();s();var R=M(at());function Oe(t){return isNaN(t)?0:Number(t*u.LAMPORTS_PER_SOL)}function ft(t,e){let o=e.mul(t.totalLamports),r=t.poolTokenSupply;return o.lt(r)?new R.default(0):o.div(r)}async function Ft(t,e){let[o]=await u.PublicKey.findProgramAddress([e.toBuffer(),Buffer.from("withdraw")],t);return o}async function kt(t,e,o,r){let[a]=await u.PublicKey.findProgramAddress([e.toBuffer(),o.toBuffer(),r?new R.default(r).toArrayLike(Buffer,"le",4):Buffer.alloc(0)],t);return a}function tt(t){if(typeof t=="number")return Math.abs(t)/u.LAMPORTS_PER_SOL;if(typeof t=="bigint")return Math.abs(Number(t))/u.LAMPORTS_PER_SOL;let e=1;t.isNeg()&&(e=-1);let r=t.abs().toString(10).padStart(10,"0"),a=r.length-9,n=r.slice(0,a)+"."+r.slice(a);return e*parseFloat(n)}async function or(t,e,o,r){let[a]=await u.PublicKey.findProgramAddress([ve,e.toBuffer(),o.toBuffer(),r.toArrayLike(Buffer,"le",8)],t);return a}function rr(t,e){return t.poolTokenSupply.isZero()||t.totalLamports.isZero()?e:e.mul(t.poolTokenSupply).div(t.totalLamports)}async function Ve(t,e,o,r,a,n){let m=await t.getAccountInfo(e.validatorList),d=St.decode(m?.data);if(!d?.validators||d?.validators.length==0)throw new Error("No accounts found");let A=await t.getMinimumBalanceForRentExemption(u.StakeProgram.space),S=new R.default(A+X),p=[];for(let T of d.validators){if(T.status!==0)continue;let L=await kt(K,T.voteAccountAddress,o);if(!T.activeStakeLamports.isZero()){let _=e?.preferredWithdrawValidatorVoteAddress?.equals(T.voteAccountAddress);p.push({type:_?"preferred":"active",voteAddress:T.voteAccountAddress,stakeAddress:L,lamports:T.activeStakeLamports})}let E=T.transientStakeLamports.sub(S);if(E.gt(new R.default(0))){let _=await or(K,T.voteAccountAddress,o,T.transientSeedSuffixStart);p.push({type:"transient",voteAddress:T.voteAccountAddress,stakeAddress:_,lamports:E})}}p=p.sort(a||((T,L)=>L.lamports.sub(T.lamports).toNumber()));let h=await t.getAccountInfo(e.reserveStake),b=new R.default((h?.lamports??0)-A);b.gt(new R.default(0))&&p.push({type:"reserve",stakeAddress:e.reserveStake,lamports:b});let v=[],f=new R.default(r),P=e.stakeWithdrawalFee,I={numerator:P.denominator.sub(P.numerator),denominator:P.denominator};for(let T of["preferred","active","transient","reserve"]){let L=p.filter(E=>E.type==T);for(let{stakeAddress:E,voteAddress:_,lamports:N}of L){if(N.lte(S)&&T=="transient")continue;let g=rr(e,N);!n&&!I.numerator.isZero()&&(g=g.mul(I.denominator).div(I.numerator));let V=R.default.min(g,f);if(!V.lte(new R.default(0))&&(v.push({stakeAddress:E,voteAddress:_,poolAmount:V}),f=f.sub(V),f.isZero()))break}if(f.isZero())break}if(f.gt(new R.default(0)))throw new Error(`No stake accounts found in this pool with enough balance to withdraw ${tt(r)} pool tokens.`);return v}function Re(t,e,o){let r=u.Keypair.generate();return e.push(u.SystemProgram.createAccount({fromPubkey:t,newAccountPubkey:r.publicKey,lamports:o,space:u.StakeProgram.space,programId:u.StakeProgram.programId})),r}async function De(t,e){let o=await t.getAccountInfo(e);if(!o)throw new Error("Invalid stake pool account");return{pubkey:e,account:{data:Ne.decode(o.data),executable:o.executable,lamports:o.lamports,owner:o.owner}}}async function ar(t,e){let o=(await t.getParsedAccountInfo(e)).value;if(!o||!("parsed"in o.data))throw new Error("Invalid stake account");if(o.data.program!="stake")throw new Error("Not a stake account");return Ke.parse(o.data.parsed)}async function qn(t,e,o,r,a,n,m,d){let A=await t.getBalance(o,"confirmed");if(A<r)throw new Error(`Not enough SOL to deposit into pool. Maximum deposit amount is ${tt(A)} SOL.`);let p=(await De(t,e)).account.data,h=new u.Keypair,b=[h],v=[];if(v.push(u.SystemProgram.transfer({fromPubkey:o,toPubkey:h.publicKey,lamports:r})),!a){let P=Pt(p.poolMint,o);v.push(ae(o,P,o,p.poolMint)),a=P}let f=await Ft(K,e);return v.push(Z.depositSol({stakePool:e,reserveStake:p.reserveStake,fundingAccount:h.publicKey,destinationPoolAccount:a,managerFeeAccount:p.managerFeeAccount,referralPoolAccount:m??a,poolMint:p.poolMint,lamports:r,withdrawAuthority:f,depositAuthority:d,referralAccount:n})),{instructions:v,signers:b}}async function Ce(t,e,o,r,a=!1,n,m,d,A){let S=await De(t,e),p=new et.default(Oe(r));d||(d=Pt(S.account.data.poolMint,o));let h=await oe(t,d);if(h.amount<p.toNumber())throw new Error(`Not enough token balance to withdraw ${tt(p)} pool tokens.
          Maximum withdraw amount is ${tt(h.amount)} pool tokens.`);let b=await t.getMinimumBalanceForRentExemption(u.StakeProgram.space),v=await Ft(K,e),f=null;m&&(f=await ar(t,m));let P=[];if(a)P.push({stakeAddress:S.account.data.reserveStake,voteAddress:void 0,poolAmount:p});else if(f&&f?.type=="delegated"){let g=f.info?.stake?.delegation.voter;if(!g)throw new Error(`Invalid stake reciever ${m} delegation`);let V=await t.getAccountInfo(S.account.data.validatorList),D=St.decode(V?.data).validators.find(C=>C.voteAccountAddress.equals(g));if(n&&n!==g)throw new Error(`Provided withdrawal vote account ${n} does not match delegation on stake receiver account ${g},
        remove this flag or provide a different stake account delegated to ${n}`);if(D){let C=await kt(K,g,e),ot=await t.getAccountInfo(C);if(!ot)throw new Error("Preferred withdraw valdator's stake account is invalid");let rt=ft(S.account.data,new et.default(ot.lamports-X-b));if(rt.lt(p))throw new Error(`Not enough lamports available for withdrawal from ${C},
              ${p} asked, ${rt} available.`);P.push({stakeAddress:C,voteAddress:g,poolAmount:p})}else throw new Error(`Provided stake account is delegated to a vote account ${g} which does not exist in the stake pool`)}else if(n){let g=await kt(K,n,e),V=await t.getAccountInfo(g);if(!V)throw new Error("Invalid Stake Account");let B=new et.default(V.lamports-X-b);if(B.lt(new et.default(0)))throw new Error("Invalid Stake Account");let D=ft(S.account.data,B);if(D.lt(p))throw new Error(`Not enough lamports available for withdrawal from ${g},
            ${p} asked, ${D} available.`);P.push({stakeAddress:g,voteAddress:n,poolAmount:p})}else{let g=await Ve(t,S.account.data,e,p,A,d.equals(S.account.data.managerFeeAccount));P.push(...g)}let I=[],T=u.Keypair.generate(),L=[T];I.push(le(d,T.publicKey,o,p.toNumber()));let E=0,_=5,N=0;for(let g of P){if(N>_)break;let B=`Withdrawing \u25CE${ft(S.account.data,g.poolAmount)},
        from stake account ${g.stakeAddress?.toBase58()}`;g.voteAddress&&(B=`${B}, delegated to ${g.voteAddress?.toBase58()}`);let D;if(!m||f&&f.type==="delegated"){let C=Re(o,I,b);L.push(C),E+=b,D=C.publicKey}else D=m;I.push(Z.withdrawStake({stakePool:e,validatorList:S.account.data.validatorList,validatorStake:g.stakeAddress,destinationStake:D,destinationStakeAuthority:o,sourceTransferAuthority:T.publicKey,sourcePoolAccount:d,managerFeeAccount:S.account.data.managerFeeAccount,poolMint:S.account.data.poolMint,poolTokens:g.poolAmount.toNumber(),withdrawAuthority:v})),N++}return m&&f&&f.type==="delegated"&&L.forEach(g=>{I.concat(u.StakeProgram.merge({stakePubkey:m,sourceStakePubKey:g.publicKey,authorizedPubkey:o}).instructions)}),{instructions:I,signers:L,stakeReceiver:m,totalRentFreeBalances:E}}function nr(t){let{t:e}=Ht(),o=nt(),r=Kt(),{mutateAsync:a}=ie(t);return Qt({mutationFn:async({stakePoolAddress:d,amount:A,accountIdentifier:S,senderAddress:p})=>{let{networkID:h,address:b}=p,v=new u.PublicKey(b),f=new u.PublicKey(b),{instructions:P,signers:I}=await Ce(t,d,v,A,!1).catch(N=>{throw ht.captureError(N,"staking"),N}),T=new Y.Transaction;T.add(...P);let L=await Zt(T,{connection:t}),E={ownerAddress:b??"",networkID:h,data:{signature:""},type:"withdrawStake",display:{summary:{topLeft:{text:e("transactionsPendingWithdrawingStake")}}}};r.approved({chainType:"solana",chainName:"solana",networkId:W.getSolanaNetworkIDValue(h),type:"withdraw-liquid-stake"});let _=await a({accountIdentifier:S,feePayer:f,transaction:L,pendingTransactionInput:E,opts:{additionalSignerAccounts:I}});return r.submittedTransaction(_,{chainType:"solana",chainName:"solana",networkId:W.getSolanaNetworkIDValue(h),method:"signAndSendTransaction"}),{networkID:h,id:_}},onSuccess:d=>{st({connection:t,signature:d.id}).then(()=>{r.transactionStatus(d.id,{chainType:"solana",chainName:"solana",networkId:W.getSolanaNetworkIDValue(d.networkID),status:{type:"confirmed"}})}).catch(A=>{r.transactionStatus(d.id,{chainType:"solana",chainName:"solana",networkId:W.getSolanaNetworkIDValue(d.networkID),status:{type:"error"}}),ht.captureError(A,"staking")}),Vt(t,d.id,o)}})}i();s();i();s();var di={name:"Jito",stakePoolAddress:"Jito4APyf642JPZPx3hGc6WWJ8zPKtRbRs4P815Awbb",apy:"0.0760131222374123",convertRatio:"1.1067926864808721",stakePoolTokenMetadata:{metadata:{address:"J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn",name:"Jito Staked SOL",symbol:"JitoSOL",decimals:9,logoURI:"https://storage.googleapis.com/token-metadata/JitoSOL-256.png",chainId:"solana:101"},caip19:"solana:101/address:J1toso1uCk3RLmjorhTtrVwY9HJ7X8V9yYac6Y7kGCPn"},chainId:"solana:101",validators:[{vote_account:"validator"}]},Me={name:"Phantom Staked SOL",stakePoolAddress:"pSPcvR8GmG9aKDUbn9nbKYjkxt9hxMS7kF1qqKJaPqJ",apy:"0.0950000000000000",convertRatio:"1.0500000000000000",stakePoolTokenMetadata:{metadata:{address:se,name:"Phantom Staked SOL",symbol:"PSOL",decimals:9,logoURI:"https://storage.googleapis.com/token-metadata/PSOL-256.png",chainId:"solana:101"},caip19:"solana:101/address:pSo1f9nQXWgXibFtKf7NWYxb5enAM4qfP6UJSiXRQfL"},chainId:"solana:101",validators:[{vote_account:"validator"}]};function ir(t){return t?t.stakePoolTokenMetadata.caip19===Me.stakePoolTokenMetadata.caip19:!1}export{Qe as a,$e as b,He as c,wr as d,Xe as e,Ze as f,to as g,eo as h,oo as i,ro as j,Pr as k,Tr as l,wo as m,Po as n,Na as o,pe as p,ut as q,me as r,Kt as s,Pe as t,_o as u,go as v,ho as w,Ot as x,No as y,rn as z,Vt as A,Le as B,qn as C,nr as D,ir as E};
//# sourceMappingURL=chunk-GZVOHEMO.js.map
