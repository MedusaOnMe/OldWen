import{$c as Ct,Mb as Et,Sb as At,Xc as ke,Yc as Bt,Zb as wt,ic as ht}from"./chunk-U6X5ZLHM.js";import{Rd as kt,Za as Z,cb as ft,db as mt,eb as be,fb as V,tb as pt}from"./chunk-M4V43KDP.js";import{i as O,l as X}from"./chunk-46FGAK6J.js";import{m as gt,n as yt,o as Tt,p as bt,r as vt,w as ve,z as L}from"./chunk-VU23O6LP.js";import{u as N}from"./chunk-YTFWYDJ6.js";import{a as Te,c as H,i as s}from"./chunk-O2FNG2JZ.js";import{f as ye,h as l,i as y,n as d}from"./chunk-3KENBVE7.js";l();d();var Mn=0;function b(e,t){let n=`atom${++Mn}`,o={toString(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?o.read=e:(o.init=e,o.read=Dn,o.write=xn),t&&(o.write=t),o}function Dn(e){return e(this)}function xn(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}var Pt=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,$e=e=>"init"in e,He=e=>!!e.write,Ae=new WeakMap,qe=e=>{var t;return Je(e)&&!((t=Ae.get(e))!=null&&t[1])},Nn=(e,t)=>{let n=Ae.get(e);if(n)n[1]=!0,n[0].forEach(o=>o(t));else if((import.meta.env?import.meta.env.MODE:void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},Un=e=>{if(Ae.has(e))return;let t=[new Set,!1];Ae.set(e,t);let n=()=>{t[1]=!0};e.then(n,n),e.onCancel=o=>{t[0].add(o)}},Je=e=>typeof e?.then=="function",Mt=e=>"v"in e||"e"in e,Ee=e=>{if("e"in e)throw e.e;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},Dt=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},Ln=(e,t,n,o)=>{var i;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&n===e)throw new Error("[Bug] atom cannot depend on itself");t.d.set(n,o.n),qe(t.v)&&Dt(e,t.v,o),(i=o.m)==null||i.t.add(e)},Rn=Symbol.for("JOTAI.EXPERIMENTAL.FLUSHSTOREHOOK"),xt=(...e)=>{let[t,n,o,i,a,m]=e,u=k=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!k)throw new Error("Atom is undefined or null");let g=t(k);return g||(g={d:new Map,p:new Set,n:0},n(k,g),a?.(k,ge)),g},f=new WeakMap,c=new Map,p=new Set,T=new Set,v=()=>{var k;let g=[],E=A=>{try{A()}catch(B){g.push(B)}};do{(k=ge[Rn])==null||k.call(ge);let A=new Set,B=A.add.bind(A);c.forEach(h=>{var P;return(P=h.m)==null?void 0:P.l.forEach(B)}),c.clear(),p.forEach(B),p.clear(),T.forEach(B),T.clear(),A.forEach(E),c.size&&ie()}while(c.size||p.size||T.size);if(g.length)throw g[0]},w=(k,g,E)=>{let A="v"in g,B=g.v,h=qe(g.v)?g.v:null;if(Je(E)){Un(E);for(let P of g.d.keys())Dt(k,E,u(P));g.v=E}else g.v=E;delete g.e,(!A||!Object.is(B,g.v))&&(++g.n,h&&Nn(h,E))},C=k=>{var g;let E=u(k);if(Mt(E)&&(E.m&&f.get(k)!==E.n||Array.from(E.d).every(([M,j])=>C(M).n===j)))return E;E.d.clear();let A=!0,B=()=>{E.m&&(We(k,E),ie(),v())},h=M=>{if(Pt(k,M)){let je=u(M);if(!Mt(je))if($e(M))w(M,je,M.init);else throw new Error("no atom init");return Ee(je)}let j=C(M);try{return Ee(j)}finally{Ln(k,E,M,j),A||B()}},P,x,F={get signal(){return P||(P=new AbortController),P.signal},get setSelf(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!He(k)&&console.warn("setSelf function cannot be used with read-only atom"),!x&&He(k)&&(x=(...M)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&A&&console.warn("setSelf function cannot be called in sync"),!A)return dt(k,...M)}),x}};try{let M=o(k,h,F);return w(k,E,M),Je(M)&&((g=M.onCancel)==null||g.call(M,()=>P?.abort()),M.then(B,B)),E}catch(M){return delete E.v,E.e=M,++E.n,E}finally{A=!1}},D=k=>Ee(C(k)),K=k=>{var g;let E=new Map;for(let A of((g=k.m)==null?void 0:g.t)||[]){let B=u(A);B.m&&E.set(A,B)}for(let A of k.p)E.set(A,u(A));return E},Y=k=>{let g=[k];for(;g.length;){let E=g.pop();for(let[A,B]of K(E))f.has(A)||(f.set(A,B.n),g.push(B))}},ie=()=>{var k;let g=[],E=new WeakSet,A=new WeakSet,B=Array.from(c);for(;B.length;){let[h,P]=B[B.length-1];if(A.has(h)){B.pop();continue}if(E.has(h)){f.get(h)===P.n?g.push([h,P,P.n]):(f.delete(h),c.set(h,P)),A.add(h),B.pop();continue}E.add(h);for(let[x,F]of K(P))E.has(x)||B.push([x,F])}for(let h=g.length-1;h>=0;--h){let[P,x,F]=g[h],M=!1;for(let j of x.d.keys())if(j!==P&&c.has(j)){M=!0;break}M&&(C(P),We(P,x),F!==x.n&&(c.set(P,x),(k=x.u)==null||k.call(x))),f.delete(P)}},Ge=(k,...g)=>{let E=!0,A=h=>Ee(C(h)),B=(h,...P)=>{var x;let F=u(h);try{if(Pt(k,h)){if(!$e(h))throw new Error("atom not writable");let M=F.n,j=P[0];w(h,F,j),We(h,F),M!==F.n&&(c.set(h,F),(x=F.u)==null||x.call(F),Y(F));return}else return Ge(h,...P)}finally{E||(ie(),v())}};try{return i(k,A,B,...g)}finally{E=!1}},dt=(k,...g)=>{try{return Ge(k,...g)}finally{ie(),v()}},We=(k,g)=>{var E;if(g.m&&!qe(g.v)){for(let[A,B]of g.d)if(!g.m.d.has(A)){let h=u(A);Qe(A,h).t.add(k),g.m.d.add(A),B!==h.n&&(c.set(A,h),(E=h.u)==null||E.call(h),Y(h))}for(let A of g.m.d||[])if(!g.d.has(A)){g.m.d.delete(A);let B=ze(A,u(A));B?.t.delete(k)}}},Qe=(k,g)=>{var E;if(!g.m){C(k);for(let A of g.d.keys())Qe(A,u(A)).t.add(k);if(g.m={l:new Set,d:new Set(g.d.keys()),t:new Set},(E=g.h)==null||E.call(g),He(k)){let A=g.m,B=()=>{let h=!0,P=(...x)=>{try{return Ge(k,...x)}finally{h||(ie(),v())}};try{let x=m(k,P);x&&(A.u=()=>{h=!0;try{x()}finally{h=!1}})}finally{h=!1}};T.add(B)}}return g.m},ze=(k,g)=>{var E;if(g.m&&!g.m.l.size&&!Array.from(g.m.t).some(A=>{var B;return(B=u(A).m)==null?void 0:B.d.has(k)})){let A=g.m.u;A&&p.add(A),delete g.m,(E=g.h)==null||E.call(g);for(let B of g.d.keys()){let h=ze(B,u(B));h?.t.delete(k)}return}return g.m},ge={get:D,set:dt,sub:(k,g)=>{let E=u(k),B=Qe(k,E).l;return B.add(g),v(),()=>{B.delete(g),ze(k,E),v()}},unstable_derive:k=>xt(...k(...e))};return ge},Fn=e=>{let t=new Set,n,o=0,i=e.unstable_derive((...u)=>{let[f,c,,p]=u;return n=f,u[1]=function(v,w){c(v,w);let C=w.h;w.h=()=>{C?.(),w.m?t.add(v):t.delete(v)}},u[3]=function(v,w,C,...D){return o?C(v,...D):p(v,w,C,...D)},u}),a=i.set;return Object.assign(i,{dev4_get_internal_weak_map:()=>({get:u=>{let f=n(u);if(!(!f||f.n===0))return f}}),dev4_get_mounted_atoms:()=>t,dev4_restore_atoms:u=>{a({read:()=>null,write:(c,p)=>{++o;try{for(let[T,v]of u)$e(T)&&p(T,v)}finally{--o}}})}})},Se=()=>{let e=new WeakMap,t=xt(n=>e.get(n),(n,o)=>e.set(n,o).get(n),(n,...o)=>n.read(...o),(n,...o)=>n.write(...o),(n,...o)=>{var i;return(i=n.unstable_onInit)==null?void 0:i.call(n,...o)},(n,...o)=>{var i;return(i=n.onMount)==null?void 0:i.call(n,...o)});return(import.meta.env?import.meta.env.MODE:void 0)!=="production"?Fn(t):t},se,Nt=()=>(se||(se=Se(),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=se),globalThis.__JOTAI_DEFAULT_STORE__!==se&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),se);l();d();var U=ye(Te(),1);var Lt=(0,U.createContext)(void 0),Rt=e=>{let t=(0,U.useContext)(Lt);return e?.store||t||Nt()},fo=({children:e,store:t})=>{let n=(0,U.useRef)(void 0);return!t&&!n.current&&(n.current=Se()),(0,U.createElement)(Lt.Provider,{value:t||n.current},e)},Ye=e=>typeof e?.then=="function",Ft=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},Vn=U.default.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(Ft(e),e)}),Ze=new WeakMap,Ut=e=>{let t=Ze.get(e);return t||(t=new Promise((n,o)=>{let i=e,a=f=>c=>{i===f&&n(c)},m=f=>c=>{i===f&&o(c)},u=f=>{"onCancel"in f&&typeof f.onCancel=="function"&&f.onCancel(c=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&c===f)throw new Error("[Bug] p is not updated even after cancelation");Ye(c)?(Ze.set(c,t),i=c,c.then(a(c),m(c)),u(c)):n(c)})};e.then(a(e),m(e)),u(e)}),Ze.set(e,t)),t};function R(e,t){let n=Rt(t),[[o,i,a],m]=(0,U.useReducer)(c=>{let p=n.get(e);return Object.is(c[0],p)&&c[1]===n&&c[2]===e?c:[p,n,e]},void 0,()=>[n.get(e),n,e]),u=o;(i!==n||a!==e)&&(m(),u=n.get(e));let f=t?.delay;if((0,U.useEffect)(()=>{let c=n.sub(e,()=>{if(typeof f=="number"){let p=n.get(e);Ye(p)&&Ft(Ut(p)),setTimeout(m,f);return}m()});return m(),c},[n,e,f]),(0,U.useDebugValue)(u),Ye(u)){let c=Ut(u);return Vn(c)}return u}function ae(e,t){let n=Rt(t);return(0,U.useCallback)((...i)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...i)},[n,e])}function mo(e,t){return[R(e,t),ae(e,t)]}l();d();var me=ye(Te());l();d();l();d();l();d();var I=b(new yt);function Oe(){return Oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Oe.apply(this,arguments)}y.NODE_ENV!=="production"&&(I.debugPrivate=!0);var Kn=(e,t,n)=>e?.suspense&&Gn(t,n),Gn=(e,t)=>e.isPending&&!t,Wn=({result:e,throwOnError:t,query:n})=>e.isError&&!e.isFetching&&Qn(t,[e.error,n]);function Qn(e,t){return typeof e=="function"?e(...t):!!e}var zn=e=>e.suspense&&typeof e.staleTime!="number"?Oe({},e,{staleTime:1e3}):e;function Vt(e,t,n=o=>o(I)){let o=b(0),i=b(n);y.NODE_ENV!=="production"&&(i.debugPrivate=!0);let a=b(()=>new WeakMap);y.NODE_ENV!=="production"&&(a.debugPrivate=!0);let m=b(c=>{let p=c(i),T=e(c),v=p.defaultQueryOptions(T),w=c(a).get(p);return v._optimisticResults="optimistic",w&&w.setOptions(v,{listeners:!1}),zn(v)});y.NODE_ENV!=="production"&&(m.debugPrivate=!0);let u=b(c=>{let p=c(i),T=c(m),v=c(a),w=v.get(p);if(w)return w;let C=new t(p,T);return v.set(p,C),C});y.NODE_ENV!=="production"&&(u.debugPrivate=!0);let f=b(c=>{let p=c(u),T=c(m),v=p.getOptimisticResult(T),w=b(v);return y.NODE_ENV!=="production"&&(w.debugPrivate=!0),w.onMount=C=>{let D=p.subscribe(gt.batchCalls(C));return()=>{p.getCurrentResult().isError&&p.getCurrentQuery().reset(),D()}},w});return y.NODE_ENV!=="production"&&(f.debugPrivate=!0),b(c=>{c(o);let p=c(u),T=c(m),v=c(c(f));if(Kn(T,v,!1))return p.fetchOptimistic(T);if(Wn({result:v,query:p.getCurrentQuery(),throwOnError:T.throwOnError}))throw v.error;return v},(c,p)=>{p(o,T=>T+1)})}function we(e,t=n=>n(I)){return Vt(e,Tt,t)}function Kt(e,t=n=>n(I)){return Vt(e,bt,t)}l();d();var Bo=Symbol((import.meta.env?import.meta.env.MODE:void 0)!=="production"?"RESET":"");var Xe=(e,t,n)=>(t.has(n)?t:t.set(n,e())).get(n),jn=new WeakMap,Hn=(e,t,n,o)=>{let i=Xe(()=>new WeakMap,jn,t),a=Xe(()=>new WeakMap,i,n);return Xe(e,a,o)};function G(e,t,n=Object.is){return Hn(()=>{let o=Symbol(),i=([m,u])=>{if(u===o)return t(m);let f=t(m,u);return n(u,f)?u:f},a=b(m=>{let u=m(a),f=m(e);return i([f,u])});return a.init=o,a},e,t,n)}var $n=e=>typeof e?.then=="function";function qn(e=()=>{try{return self.localStorage}catch(n){(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&typeof self<"u"&&console.warn(n);return}},t){var n;let o,i,a={getItem:(f,c)=>{var p,T;let v=C=>{if(C=C||"",o!==C){try{i=JSON.parse(C,t?.reviver)}catch{return c}o=C}return i},w=(T=(p=e())==null?void 0:p.getItem(f))!=null?T:null;return $n(w)?w.then(v):v(w)},setItem:(f,c)=>{var p;return(p=e())==null?void 0:p.setItem(f,JSON.stringify(c,t?.replacer))},removeItem:f=>{var c;return(c=e())==null?void 0:c.removeItem(f)}},m=f=>(c,p,T)=>f(c,v=>{let w;try{w=JSON.parse(v||"")}catch{w=T}p(w)}),u;try{u=(n=e())==null?void 0:n.subscribe}catch{}return!u&&typeof self<"u"&&typeof self.addEventListener=="function"&&self.Storage&&(u=(f,c)=>{if(!(e()instanceof self.Storage))return()=>{};let p=T=>{T.storageArea===e()&&T.key===f&&c(T.newValue)};return self.addEventListener("storage",p),()=>{self.removeEventListener("storage",p)}}),u&&(a.subscribe=m(u)),a}var Co=qn();l();d();l();d();l();d();var Jn=e=>Ct(e)?.[0],Gt=Jn;function Sn({caip19:e,...t}){let n=be(e);return{...t,type:e.includes("/nativeToken:")?"native":"fungible",chainName:Z.getChainName(n.chainId).toLowerCase(),encodedCaip19:e,decodedCaip19:n,legacyKey:Gt(n)??e}}var _=Sn;var Zn=s.object({account:s.string(),quantity:s.number(),quantityString:s.string()}),ce=s.object({address:s.string(),quantity:s.number(),quantityString:s.string(),lastTransferredDate:s.coerce.date().nullish(),subaccounts:s.array(Zn).optional()}),ee=s.object({price:s.number(),priceChange24h:s.number().optional(),lastUpdatedAt:s.coerce.date(),marketCap:s.number().optional()}).nullish(),Ie=s.object({id:s.string(),name:s.string(),imageUri:s.string().nullish().transform(e=>e??""),numTokens:s.number()}),ue=s.object({compression:s.object({compressed:s.boolean()}).optional(),creators:s.array(s.object({address:s.string(),share:s.number(),verified:s.boolean()})).nullish(),tokenProgram:s.string().nullish(),extensions:s.array(s.unknown()).nullish()}),he=s.enum(["VERIFIED","NOT_VERIFIED","POSSIBLE_SPAM","SPAM"]),jo=s.object({totalValueUsdCentsCurrent:s.number().optional(),totalValueUsdStringCurrent:s.string().optional(),totalValueUsdCents24h:s.number().optional(),totalValueUsdString24h:s.string().optional(),totalPercentChange24h:s.number().optional()}),Wt=s.object({name:s.string().nullish(),symbol:s.string().nullish(),decimals:s.number(),logoUri:s.string().nullish(),extraMetadata:ue.optional(),price:ee}),Be=Wt.extend({type:s.enum(["native","fungible"]),encodedCaip19:s.string(),decodedCaip19:mt,spamStatus:he,chainName:s.string(),legacyKey:s.string()}),Yn=Wt.extend({caip19:s.string(),spamStatus:he.nullish().transform(e=>e??"NOT_VERIFIED")}),Qt=s.union([Yn.transform(e=>_(e)),Be]),Ho=Be.extend({extraMetadata:ue.extend({id:s.string().nullish().default(null),description:s.string().nullish().default(null),marketCap:s.coerce.number().optional(),circulatingSupply:s.coerce.number().optional(),totalSupply:s.coerce.number().optional(),liquidity:s.coerce.number().optional(),holders:s.coerce.number().optional(),links:s.array(s.object({type:s.string(),url:s.string()})).optional(),volume24hUSD:s.coerce.number().optional(),volume24hUSDChangePercentage:s.coerce.number().optional(),trades24h:s.coerce.number().optional(),trades24hChangePercentage:s.coerce.number().optional(),uniqueWallets24h:s.coerce.number().optional(),uniqueWallets24hChangePercentage:s.coerce.number().optional(),top10HoldersPercent:s.coerce.number().optional(),mintable:s.boolean().optional(),freezable:s.boolean().optional(),mutableMetadata:s.boolean().optional(),ownershipRenounced:s.boolean().optional(),updateAuthority:s.string().optional()}).optional(),categories:s.array(Ie),createdDate:s.coerce.date().nullish().default(null)}),zt=Be.extend({totalQuantity:s.number(),totalQuantityString:s.string(),walletAddress:s.string().optional(),queriedWalletBalances:s.array(ce),livePrice:ee}),jt=Be.extend({timestamp:s.string().nullish(),totalQuantityString:s.string(),totalQuantity:s.number(),queriedWalletBalances:s.array(ce)});l();d();l();d();l();d();function Q(e){let t=b(0),n=b(()=>({i:0}),(f,c)=>{let p=f(n);return Object.assign(p,{m:!0,peek:f,set:c}),c(t,T=>T+1),()=>{p.m=!1,m(p),u(p)}});n.onMount=f=>f();let o=b(f=>{f(t);let c=f(n);if(!c.m||c.irc||c.i&&!c.irf)return c.p;u(c);let p=new Map,T=D=>{let K=f(D);return p.set(D,K),K};T.peek=c.peek;let v=(...D)=>{try{return++c.i,c.set(...D)}finally{Array.from(p.keys(),f),--c.i}};v.recurse=(D,...K)=>{if(c.fc){if(y.NODE_ENV!=="production")throw new Error("set.recurse is not allowed in cleanup");return}try{return c.irc=!0,c.set(D,...K)}finally{c.irc=!1,Array.from(p).some(w)&&a(c)}};function w([D,K]){return f(D)!==K}++c.i;function C(){try{if(c.irf=!1,!c.m)return;m(c),c.c=i.effect(T,v)}catch(D){c.e=D,a(c)}finally{c.p=void 0,--c.i}}return c.irf?C():c.p=Promise.resolve().then(C)});if(y.NODE_ENV!=="production"){let f=function(c,p){Object.defineProperty(c,"debugLabel",{get:()=>`${i.debugLabel??"effect"}:${p}`}),c.debugPrivate=!0};f(t,"refresh"),f(n,"ref"),f(o,"base")}let i=b(f=>void f(o));return i.effect=e,i;function a(f){try{f.irf=!0,f.set(t,c=>c+1)}finally{f.irf=!1}}function m(f){if(typeof f.c=="function")try{f.fc=!0,f.c()}finally{f.fc=!1,f.c=void 0}}function u(f){if("e"in f){let c=f.e;throw delete f.e,c}}}l();d();var On=()=>{try{return typeof chrome<"u"&&(chrome.runtime?.id!==void 0||typeof browser<"u")}catch(e){return console.error("Error checking for extension context:",e),!1}},_e=class{browser;storage;constructor(t){if(!t||!t.storage||!t.storage.local)throw new Error("[ExtensionStorage] Invalid 'browser' object received.");this.browser=t,this.storage=this.browser.storage.local}async get(t){try{let o=(await this.storage.get(t))[t];return o==null||typeof o!="string"?null:JSON.parse(o)}catch(n){return console.error(`[ExtensionStorage.get] Error getting/parsing key (${t}):`,n),null}}async getAll(t){try{let n=await this.storage.get(t),o={};for(let i in n)if(Object.prototype.hasOwnProperty.call(n,i)){let a=n[i];if(a==null||typeof a!="string")o[i]=null;else try{o[i]=JSON.parse(a)}catch(m){console.error(`[ExtensionStorage.getAll] Error parsing key (${i}):`,m),o[i]=null}}return o}catch(n){let o=`[ExtensionStorage.getAll] Error getting keys (${t}): ${n}`;throw console.error(o),new Error(o)}}async remove(t){try{await this.storage.remove(t)}catch(n){let o=`[ExtensionStorage.remove] Error removing key(s) (${t}): ${n}`;throw console.error(o),new Error(o)}}async set(t,n){try{let o=JSON.stringify(n);await this.storage.set({[t]:o})}catch(o){let i=`[ExtensionStorage.set] Error setting/stringifying key (${t}): ${o}`;throw console.error(i),new Error(i)}}async setAll(t){try{let n={};for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=JSON.stringify(t[o]));await this.storage.set(n)}catch(n){let i=`[ExtensionStorage.setAll] Error setting/stringifying keys (${Object.keys(t)}): ${n}`;throw console.error(i),new Error(i)}}async update(t,n){if(!navigator.locks){let o=await this.get(t),i=await n(o);i===null?await this.remove(t):await this.set(t,i);return}try{await navigator.locks.request(`storage.${t}`,async o=>{let i=await this.get(t),a=await n(i);a===null?await this.remove(t):await this.set(t,a)})}catch(o){let i=`[ExtensionStorage.update] Error updating key (${t}): ${o}`;throw console.error(i),new Error(i)}}async clear(){try{await this.storage.clear()}catch(t){let n=`[ExtensionStorage.clear] Error clearing storage: ${t}`;throw console.error(n),new Error(n)}}},Ce=class{storage=self.localStorage;async get(t){try{let n=this.storage.getItem(t);return n===null||typeof n!="string"?null:JSON.parse(n)}catch(n){return console.error(`[WebLocalStorage.get] Error getting/parsing key (${t}):`,n),null}}async getAll(t){let n={},o=t??Object.keys(this.storage);for(let i of o)try{let a=this.storage.getItem(i);if(t&&a===null)continue;if(a===null||typeof a!="string")n[i]=null;else try{n[i]=JSON.parse(a)}catch(m){console.error(`[WebLocalStorage.getAll] Error parsing key (${i}):`,m),n[i]=null}}catch(a){console.error(`[WebLocalStorage.getAll] Error reading key (${i}) from storage:`,a),t||(n[i]=null)}return n}async remove(t){try{let n=Array.isArray(t)?t:[t];for(let o of n)this.storage.removeItem(o)}catch(n){let o=`[WebLocalStorage.remove] Error removing key(s) (${t}): ${n}`;throw console.error(o),new Error(o)}}async set(t,n){try{let o=JSON.stringify(n);this.storage.setItem(t,o)}catch(o){let i=`[WebLocalStorage.set] Error setting/stringifying key (${t}): ${o}`;throw console.error(i),new Error(i)}}async setAll(t){let n=!1,o=Object.keys(t);for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i))try{await this.set(i,t[i])}catch{n=!0}if(n)throw new Error(`[WebLocalStorage.setAll] One or more errors occurred while setting keys (${o})`)}async update(t,n){if(!navigator.locks){let o=await this.get(t),i=await n(o);i===null?await this.remove(t):await this.set(t,i);return}try{await navigator.locks.request(`storage.${t}`,async o=>{let i=await this.get(t),a=await n(i);a===null?await this.remove(t):await this.set(t,a)})}catch(o){let i=`[WebLocalStorage.update] Error updating key (${t}): ${o}`;throw console.error(i),new Error(i)}}async clear(){try{this.storage.clear()}catch(t){let n=`[WebLocalStorage.clear] Error clearing storage: ${t}`;throw console.error(n),new Error(n)}}},et=class{initPromise;storageImpl=null;constructor(){this.initPromise=this._initialize(),this.initPromise.catch(t=>{console.error("LocalStorage initialization failed:",t)})}async _initialize(){if(!this.storageImpl)if(On())try{let n=(await import("./browser-polyfill-HQBVFQ4E.js")).default;if(!n||!n.storage||!n.storage.local)throw new Error("webextension-polyfill loaded but missing storage.local API.");this.storageImpl=new _e(n)}catch{this.storageImpl=new Ce}else this.storageImpl=new Ce}async ensureInitialized(){if(await this.initPromise,!this.storageImpl)throw new Error("LocalStorage is not initialized. Initialization may have failed.")}async get(t){return await this.ensureInitialized(),this.storageImpl.get(t)}async getAll(t){return await this.ensureInitialized(),this.storageImpl.getAll(t)}async remove(t){return await this.ensureInitialized(),this.storageImpl.remove(t)}async set(t,n){return await this.ensureInitialized(),this.storageImpl.set(t,n)}async setAll(t){return await this.ensureInitialized(),this.storageImpl.setAll(t)}async update(t,n){return await this.ensureInitialized(),this.storageImpl.update(t,n)}async clear(){return await this.ensureInitialized(),this.storageImpl.clear()}},tt=new et;l();d();l();d();var le=class{namespaceKey;ttlMilliseconds;storage;onError;data={};isLoaded=!1;constructor(t){this.namespaceKey=t.namespaceKey,this.ttlMilliseconds=t.ttlMilliseconds,this.storage=t.storage,this.onError=t.onError,this._load().then(()=>{if(this._cleanupExpired())return this._save()}).catch(n=>{console.error("Failed to load data",n)})}async _load(){if(!this.isLoaded){try{let t=await this.storage.get(this.namespaceKey);t?(this.data=t,(typeof this.data!="object"||this.data===null)&&(this.onError?.(new Error("Stored data is not a valid object."),"load"),this.data={})):this.data={}}catch(t){this.onError?.(t instanceof Error?t:new Error("Failed to parse stored data"),"load"),this.data={}}this.isLoaded=!0}}async _save(){try{await this.storage.set(this.namespaceKey,this.data)}catch(t){this.onError?.(t instanceof Error?t:new Error("Failed to serialize data for storage"),"save")}}_cleanupExpired(){let t=Date.now(),n=!1;for(let o in this.data)Object.prototype.hasOwnProperty.call(this.data,o)&&this.data[o].expiresAt<=t&&(delete this.data[o],n=!0);return n}_updateExpiration(t){return this.data[t]?(this.data[t].expiresAt=Date.now()+this.ttlMilliseconds,!0):!1}async set(t,n){this.isLoaded||await this._load(),this._cleanupExpired(),this.data[t]={value:n,expiresAt:Date.now()+this.ttlMilliseconds},await this._save()}async get(t,n){this.isLoaded||await this._load();let o=this._cleanupExpired(),i=this.data[t];if(!i)return o&&await this._save(),null;let a=this._updateExpiration(t),m=n.safeParse(i.value);return m.success?((o||a)&&await this._save(),m.data):(this.onError?.(new H(m.error.issues),`get (validation failed for key: ${t})`),delete this.data[t],await this._save(),null)}async remove(t){let n=this._cleanupExpired(),o=!1;Object.prototype.hasOwnProperty.call(this.data,t)&&(delete this.data[t],o=!0),(n||o)&&await this._save()}async clear(){this.data={},await this._save()}};var Ht=new Map;function Xn({storage:e,namespaceKey:t,ttlMs:n}){let o=Ht.get(t);if(o)return o;if(!e)throw new Error("Storage is required");let i=new le({storage:e,namespaceKey:t,ttlMilliseconds:n,onError:(a,m)=>{console.error(`[PersistentStore Error - ${m}]:`,a.message),a instanceof H&&console.error("Zod Issues:",a.issues)}});return Ht.set(t,i),i}var nt=Xn;function In({atomToStoreOffline:e,namespaceKey:t,ttlMs:n,initialValue:o,schema:i,...a}){let m=b({status:"pending",value:o}),u=b(T=>{if("offlineKey"in a)return T(a.offlineKey);let v=T(e);if("offlineKey"in v&&typeof v.offlineKey=="string")return v.offlineKey;throw new Error("No key provided")}),f=Q((T,v)=>{nt({storage:tt,namespaceKey:`.offline.${t}`,ttlMs:n}).get(T(u),i).then(w=>{w&&v(m,{status:"offline",value:w})}).catch(w=>{console.error(w)})}),c=Q((T,v)=>{T(u),v(m,{status:"pending",value:o})}),p=Q((T,v)=>{let w=T(e),C=T(u);w.status==="success"&&w.data&&w.data!==T(m).value&&(v(m,{status:"live",value:w.data}),nt({storage:tt,namespaceKey:`.offline.${t}`,ttlMs:n}).set(C,w.data).catch(D=>{L.addBreadcrumb("tokens","Error storing offline data","error",{namespaceKey:t,error:D.toString()})}))});return G(b(T=>{let v=T(e);T(c),T(f),T(p);let w=T(m);return v.data?{status:"live",value:v.data}:{status:"offline",value:w.value}}),T=>T.value)}var De=In;l();d();l();d();var rt=s.object({caip19:s.string(),name:s.string().nullish(),symbol:s.string().nullish(),decimals:s.number(),spamStatus:he.nullish().transform(e=>e??"NOT_VERIFIED"),logoUri:s.string().nullish()}),$t=rt.extend({totalQuantity:s.number(),totalQuantityString:s.string(),queriedWalletBalances:s.array(ce),extraMetadata:ue.optional(),price:ee}),qt=$t.transform(_),Jt=s.object({items:s.array($t),cursor:s.string().nullish().default(null)}).transform(e=>{let{items:t,cursor:n,...o}=e;return{...o,nextCursor:n,tokens:t,updatedAt:Date.now()}}),St=rt.extend({timestamp:s.string().nullish(),postQuantityString:s.string(),postQuantity:s.number(),price:ee,queriedWalletBalances:s.array(ce)}),Zt=St.transform(e=>{let{postQuantity:t,postQuantityString:n,...o}=_(e);return{...o,totalQuantity:t,totalQuantityString:n}}),Yt=s.object({cursor:s.string().nullish().default(null),items:s.array(St)}).transform(e=>({nextCursor:e.cursor,transfers:e.items})),Bi=s.object({totalValueUsdCentsCurrent:s.number(),totalValueUsdStringCurrent:s.string(),totalValueUsdCents24h:s.number(),totalValueUsdString24h:s.string(),totalPercentChange24h:s.number()}),ot=rt.extend({createdDate:s.coerce.date().nullish().default(null),extraMetadata:ue.extend({id:s.string().nullish().default(null),description:s.string().nullish().default(null),marketCap:s.coerce.number().optional(),circulatingSupply:s.coerce.number().optional(),totalSupply:s.coerce.number().optional(),liquidity:s.coerce.number().optional(),holders:s.coerce.number().optional(),links:s.array(s.object({type:s.string(),url:s.string()})).optional(),volume24hUSD:s.coerce.number().optional(),volume24hUSDChangePercentage:s.coerce.number().optional(),trades24h:s.coerce.number().optional(),trades24hChangePercentage:s.coerce.number().optional(),uniqueWallets24h:s.coerce.number().optional(),uniqueWallets24hChangePercentage:s.coerce.number().optional(),top10HoldersPercent:s.coerce.number().optional(),mintable:s.boolean().optional(),freezable:s.boolean().optional(),mutableMetadata:s.boolean().optional(),ownershipRenounced:s.boolean().optional(),updateAuthority:s.string().optional()}).optional(),categories:s.array(Ie).optional().default([]),price:ee}),Ot=ot.transform(_);l();d();var _n=e=>Z.isBitcoinNetworkID(e.decodedCaip19.chainId)&&e.decodedCaip19.resourceType==="nativeToken"?e.queriedWalletBalances.map(o=>{let i=pt(e.decodedCaip19.chainId,o.address),a=ke.get(e.decodedCaip19.chainId).nativeTokenFungibleBalanceKey(e.decodedCaip19.chainId,i);if(!a)throw new Error("No legacy key found for bitcoin native token");return{...e,legacyKey:a,queriedWalletBalances:[o],totalQuantity:o.quantity,totalQuantityString:o.quantityString,walletAddress:o.address}}):[e],er=e=>t=>t.map(n=>e.parse(n)),Li=er(Qt),tr=e=>t=>t.flatMap(n=>{let o=e.parse(n);return _n(o)}),Xt=tr(qt),nr=e=>t=>t.map(n=>e.parse(n)),It=nr(Zt);async function rr(e){let t={walletAddresses:e.walletCaip19s.join(","),includePrices:"true"};"cursor"in e&&(t.cursor=e.cursor),"fromMicroseconds"in e?t.fromTimestamp=e.fromMicroseconds.toString():"from"in e&&(t.fromTimestamp=e.from.toString());let n=await O.api().timeout(N({seconds:30})).get("/portfolio/v1/fungibles/updates",{params:t}).then(o=>{if(X(o))return o.data;throw new Error(o.data?.message||o.data?.error||o.statusText,{cause:o.data?.code??o.data?.name})}).catch(o=>{throw L.addBreadcrumb("tokens","getTokenBalanceUpdates","error",{message:o.message,cause:o.cause,...t}),L.captureError(o,"tokens"),o});try{return Yt.parse(n)}catch(o){throw o instanceof H&&L.addBreadcrumb("tokens","getTokenBalanceUpdates parse error","error",{message:o.message,...o.issues?{issues:JSON.stringify(o.issues)}:{},result:JSON.stringify(n)}),o}}async function _t(e){let t=[],n=()=>t.at(-1)?.nextCursor;do{let o=n(),i=await rr(o?{walletCaip19s:e.walletCaip19s,cursor:o}:e);t.push(i)}while(n());return It(t.flatMap(o=>o.transfers))}l();d();var or="25.13.0",te=`fungible-tokens-${or}`,en=[te,"token-updates"],ir=[te,"token-details"],tn=[te,"portfolio-value"],sr=[te,"token-balance"],ar=[te,"infinite-token-balances"],cr=[te,"visibility-overrides"],W={infiniteTokenBalances:({walletCaip19s:e})=>[...ar,{walletCaip19s:e}],tokenBalance:({wallets:e,encodedCaip19:t,isSplCompressed:n})=>{let o=e.map(i=>typeof i=="string"?i:V({chainId:i.networkID,address:i.address,resourceType:"address"})).sort();return[...sr,{walletCaip19s:o,encodedCaip19:t,isSplCompressed:n}]},tokenUpdates:({walletCaip19s:e,from:t})=>[...en,{walletCaip19s:e,from:t}],portfolioValue:({walletCaip19s:e,include:t,exclude:n,isMainnet:o})=>[...tn,{walletCaip19s:e,include:t,exclude:n,isMainnet:o}],visibilityOverrides:({accountId:e})=>[...cr,{accountId:e}],tokenDetails:({caip19:e,includePrice:t})=>[...ir,{caip19:e,includePrice:t}]};l();d();l();d();function lr(e){let t=Bt(e.decodedCaip19);return t==="SPL"?e.extraMetadata?.compression?.compressed||"queriedWalletBalances"in e&&e.queriedWalletBalances.some(n=>!n.subaccounts?.length)?"CompressedSPL":"SPL":t}var nn=lr;function it({newUpdates:e,existingUpdates:t={}}){return e.reduce((n,o)=>n[o.encodedCaip19]?.totalQuantityString===o.totalQuantityString?n:nn(o)==="CompressedSPL"?{...n,[`${o.encodedCaip19}-compressed`]:o}:o?{...n,[o.encodedCaip19]:o}:n,t)}l();d();function dr(e){let t=e.match(/(.*\d{2}:\d{2}:\d{2})\.(?<fraction>\d+)Z/);if(!t||!t.groups?.fraction)throw new Error("Invalid date format");let n=new Date(e).getTime(),a=t.groups.fraction.padEnd(6,"0").slice(-3);return n*1e3+parseInt(a,10)}var st=dr;l();d();var fr=b(!1),rn=fr;l();d();l();d();l();d();var mr=N({minutes:5}),de=0;function bs(){if(!de){de=Math.floor(Math.random()*1e6);return}de++}async function at({walletCaip19s:e,fungibleCaip19s:t,cursor:n,cacheBust:o}){let i={walletAddresses:e.join(","),includePrices:"true"};n&&(i.cursor=n),(o||de)&&(i.cacheBust=o?.toString()||de.toString()),t&&t.length>0&&(i.fungibleAddresses=t.sort().join(","));try{let a=await O.api().timeout(N({seconds:30})).get("/portfolio/v1/fungibles/balances",{params:i}).then(u=>{if(X(u))return u.data;throw new Error(u.data?.message||u.data?.error||u.statusText,{cause:u.data?.code})}),m=Jt.parse(a);return{...m,tokens:Xt(m.tokens)}}catch(a){throw a instanceof Error&&(L.addBreadcrumb("tokens","getTokenBalances","error",{...i,message:a.message,...typeof a.cause=="string"||typeof a.cause=="number"?{cause:a.cause}:{}}),L.captureError(a,"tokens")),a}}function on({walletCaip19s:e,isEnabled:t=!0,cacheBust:n}){return{staleTime:mr,gcTime:N({days:3}),queryKey:W.infiniteTokenBalances({walletCaip19s:e}),enabled:t&&!!e.length,queryFn:async({pageParam:o})=>at({walletCaip19s:e,cursor:o,cacheBust:n}),initialPageParam:"",getNextPageParam:o=>o?.nextCursor||void 0}}function sn(e){let{walletCaip19s:t,encodedCaip19:n,queryOptions:o={enabled:!0}}=e;return{staleTime:N({seconds:10}),gcTime:N({days:3}),queryKey:W.tokenBalance({wallets:t,encodedCaip19:n}),enabled:o.enabled&&!!t.length,queryFn:async()=>(await at({walletCaip19s:t,fungibleCaip19s:[n]})).tokens}}l();d();l();d();var pr=b(null),Ne=pr;var gr=b(e=>{let t=e(Ne);return t?t.addresses.map(n=>V({chainId:n.networkID,address:n.address,resourceType:"address"})).sort():[]}),ne=gr;var yr=Kt(e=>{let t=e(ne);return on({walletCaip19s:t})}),z=yr;var Tr=b(e=>{let{data:t}=e(z),n=t?.pages[0];return!n||!n.tokens.length?0:n.updatedAt}),an=Tr;l();d();var br=G(Ne,e=>e?.identifier),$=br;var vr=1e3,cn=5e3,un=Math.ceil(cn*2.25);function ln(e){return N(e)*1e3}function kr(e){if(!e?.length)return null;let t=new Date(Date.now()-un).toISOString();return Math.floor(Math.max(...e.map(({timestamp:n})=>st(n||t))))}function Er(e){let t=kr(e);return t?t-ln({seconds:1}):null}var Ar=we(e=>{let t=e(I),n=e(an),o=Math.floor(n-N({minutes:10})),i=e(ne),a=e(rn),m=o>Date.now()-N({days:10}),u=W.tokenUpdates({walletCaip19s:i,from:o}),f=async()=>{let c=t.getQueryData(u)?.lastTimestamp;if(!c){let w=new Date(o-un).toISOString();return{updates:{},lastTimestamp:st(w)}}let p=await _t({walletCaip19s:i,fromMicroseconds:c-ln({seconds:30})}),T=t.getQueryData(u)?.updates??{};return{updates:it({newUpdates:p,existingUpdates:T}),lastTimestamp:Math.max(Er(p)??0,c)}};return{meta:{fetchCount:0},enabled:m&&!a&&i.length>0,queryKey:u,refetchInterval:c=>{let p=Number(c.meta?.fetchCount??0);return c.meta&&(c.meta.fetchCount=p+1),Math.min(Math.max(p*250,vr),cn)},queryFn:f}}),wr=De({atomToStoreOffline:Ar,offlineKey:b(e=>`${e($)??""}:token-balance-updates`),namespaceKey:"fungible-tokens",ttlMs:N({days:10}),initialValue:{updates:{},lastTimestamp:0},schema:s.object({updates:s.record(s.string(),jt),lastTimestamp:s.number()})}),hr=G(wr,e=>e?.updates??{},(e,t)=>JSON.stringify(e)===JSON.stringify(t)),Ue=hr;l();d();l();d();function Le(e){return t=>{let n=!1,o={...t};for(let[i,a]of Object.entries(e)){let m=a?.price,u=a?.lastUpdatedAt?new Date(a.lastUpdatedAt):null;if(!m||!u)continue;let f=t[i]?.price!==m&&(!t[i]?.lastUpdatedAt||u>t[i].lastUpdatedAt);n=n||f,f&&(o[i]={price:a.price,priceChange24h:a.priceChange24h,lastUpdatedAt:u})}return n?o:t}}l();d();var Br=b(e=>{let{data:t,status:n}=e(z);return{data:t?.pages.flatMap(o=>o.tokens),status:n}}),Cr=De({atomToStoreOffline:Br,offlineKey:b(e=>`${e($)??""}:infinite-tokens`),namespaceKey:"fungible-tokens",ttlMs:N({days:10}),initialValue:[],schema:s.array(zt)}),q=Cr;var Re=b({}),Pr=b(e=>e(q).slice(-100).reduce((o,i)=>(i.price&&(o[i.encodedCaip19]=i.price),o),{})),Mr=Q((e,t)=>{let n=e(Pr);!n||Object.keys(n).length===0||t(Re,Le(n))}),Dr=b(e=>{let t=e(Ue);return Object.values(t).reduce((o,i)=>(i.price&&(o[i.encodedCaip19]=i.price),o),{})}),xr=Q((e,t)=>{let n=e(Dr);!n||Object.keys(n).length===0||t(Re,Le(n))}),Nr=b(e=>(e(Mr),e(xr),e(Re)),(e,t,n)=>{t(Re,n)}),J=Nr;l();d();l();d();var Ur=G(z,e=>e.hasNextPage),re=Ur;var fe=b(1/0),Fe=b(e=>(e(Lr),e(Rr),e(re)?e(fe):0),(e,t,n)=>{if(n===null){t(fe,1/0);return}let o=Math.min(e(fe),n);o!==e(fe)&&t(fe,o)}),dn=Fe,Lr=Q((e,t)=>{let{hasNextPage:n}=e(z),o=e(q),i=e(J);if(o.length>0&&!n){t(Fe,0);return}let a=o.slice(-100).filter(m=>m.type==="fungible").map(m=>{let u=i[m.encodedCaip19]??m.price;return u?m.totalQuantity*u.price/10**m.decimals:1/0});t(Fe,Math.min(...a))}),Rr=Q((e,t)=>{e($)&&t(Fe,1/0)});function Fr(e,t){if(e.type==="native"&&t.type!=="native")return-1;if(e.type!=="native"&&t.type==="native")return 1;if(e.type==="native"&&t.type==="native")return e.name&&t.name?e.name.localeCompare(t.name):0}function Vr(e,t){if(!e&&t)return 1;if(e&&!t)return-1}function fn(e,t){if(e&&t)return e.localeCompare(t);if(e&&!t)return-1;if(!e&&t)return 1}function mn(e,t){if(e!==t)return t-e}function Kr(e){return{totalQuantity:e.totalQuantity,totalQuantityString:e.totalQuantityString}}var Gr=b(e=>{let t=e(q),n=e(Ue),o=new Set(Object.keys(n));if(t.length===0)return[];let i=t.map(a=>{let m=a.extraMetadata?.compression?.compressed?`${a.encodedCaip19}-compressed`:a.encodedCaip19,u=n[m];return u?(o.delete(m),{...a,...Kr(u)}):a});return o.forEach(a=>{let m=n[a];m&&i.push(m)}),i}),Wr=b(e=>{let t=e(J),n=e(Gr),o=e(dn),i=n.filter(a=>a.totalQuantity>0||a.type==="native").map(a=>({...a,livePrice:t[a.encodedCaip19]??a.price})).sort((a,m)=>{let u=a.livePrice?.price,f=m.livePrice?.price,c=Vr(u,f);if(c)return c;let p=a.totalQuantity/10**a.decimals,T=m.totalQuantity/10**m.decimals;if(!u&&!f){let D=Fr(a,m);if(D)return D;let K=mn(p,T);if(K)return K;let Y=fn(a.name,m.name);return Y||0}let v=(u??0)*p,w=(f??0)*T,C=mn(v,w);return C||(fn(a.name,m.name)??0)});return o?i.filter(a=>{let m=a.livePrice?.price,u=a.totalQuantity/10**a.decimals;return(m??0)*u>=o}):i}),S=Wr;l();d();function Qr(e){if(e)return typeof e=="string"||typeof e=="number"?new Date(e):e}function zr(e,{key:t,newPriceData:n}){let o=e[t];if(!n||o?.price===n?.price)return e;let i=Qr(n.lastUpdatedAt);return!i||!(!o?.lastUpdatedAt||i>o.lastUpdatedAt)?e:{...e,[t]:{price:n.price,priceChange24h:n.priceChange24h??n.usd_24h_change,lastUpdatedAt:i}}}var Ve=zr;var jr=(e,t,n)=>{let o=e.extraMetadata?.compression?.compressed,i=t.extraMetadata?.compression?.compressed;if(o!==i)return n?o?-1:1:o?1:-1},Hr=(e,t,n)=>{let o=e.legacyKey===n,i=t.legacyKey===n;if(o!==i)return o?-1:1},$r=({isSplCompressed:e,legacyKey:t},n)=>n.length?n.length===1?n[0]:[...n].sort((i,a)=>{if(e!==void 0&&(i.encodedCaip19.includes("solana:")||a.encodedCaip19.includes("solana:"))){let m=jr(i,a,e);if(m)return m}if(t){let m=Hr(i,a,t);if(m)return m}return a.totalQuantity-i.totalQuantity})[0]:null,pn=e=>{let t=R(ne),n=R(S),o=(0,me.useMemo)(()=>n.filter(u=>u.encodedCaip19===e.encodedCaip19&&(!e.legacyKey||u.legacyKey===e.legacyKey)),[e.encodedCaip19,e.legacyKey]),i=sn({...e,walletCaip19s:t});i.refetchInterval||(i.refetchInterval=N({seconds:3}));let a=ve({...i,select:u=>$r(e,u),placeholderData:o}),m=ae(J);return(0,me.useEffect)(()=>{let u=a.data;u&&!a.isPlaceholderData&&u.price&&m(f=>{let c=u.encodedCaip19,p=u.price;return Ve(f,{key:c,newPriceData:p})})},[a.data,a.isPlaceholderData,m]),a},gn=({networkID:e,queryOptions:t,addressType:n})=>{let o={chainId:e,slip44:Z.getSlip44(e),resourceType:"nativeToken"},i=ke.get(e).nativeTokenFungibleBalanceKey(e,n)??null,a=V(o);return pn({encodedCaip19:a,legacyKey:i,queryOptions:t})},qr=()=>{let{data:e}=kt(),t=(0,me.useMemo)(()=>e?.addresses.find(n=>Z.isSolanaNetworkID(n.networkID)),[e]);return gn({networkID:t?.networkID||"solana:101",addressType:t?.addressType})};l();d();l();d();l();d();l();d();function ct(e,t){return{gcTime:Et.Long,staleTime:1/0,enabled:!!t&&!!e,queryKey:W.visibilityOverrides({accountId:t??""}),async queryFn(){return!t||!e?new Map:await wt(e,t)}}}l();d();var Jr=b(null),yn=Jr;var Sr=new Map,Tn=we(e=>{let t=e(yn),n=e($);return ct(t,n)}),bn=G(Tn,e=>e.status),Zr=b(e=>e(Tn).data??Sr),oe=Zr;var Yr=b(e=>{let{isLoading:t}=e(z),n=e(q),o=e(bn);return t&&n.length===0||o==="pending"}),Ke=G(Yr,e=>e);function vn(){let e=R(S),t=R(Ke),n=R(re),o=R(oe);return{isLoading:t,hasNextPage:n,fungibleTokens:e,visibilityOverrides:o}}l();d();l();d();var kn=ye(Te());var Or=({wallets:e,encodedCaip19:t,isSplCompressed:n=!1})=>{let o=vt();return(0,kn.useCallback)(()=>void o.invalidateQueries({queryKey:W.tokenBalance({wallets:e,encodedCaip19:t,isSplCompressed:n})}),[o,e,t,n])},Xr=Or;l();d();function En({tokens:e}){return At({tokens:e}).catch(t=>{throw L.addBreadcrumb("tokens","getTokenPrices","error",{message:t.message,cause:t.cause,tokens:e.map(V).join(",")}),L.captureError(t,"tokens"),t})}l();d();l();d();var Ir=b(e=>{let t=e(oe);return e(S).filter(o=>ht(t??new Map,{key:o.legacyKey??"",spamStatus:o.spamStatus}))}),An=Ir;function wn(){let e=R(An),t=R(Ke),n=R(re),o=R(oe);return{isLoading:t,hasNextPage:n,fungibleTokens:e,visibilityOverrides:o}}l();d();var pe=ye(Te());l();d();l();d();function _r(e){let t={message:"Failed to parse token details response"};if(e instanceof H)try{t.zodIssuesJson=JSON.stringify(e.issues.map(n=>({path:n.path.join("."),message:n.message,code:n.code})))}catch{t.zodIssuesJson="Failed to stringify Zod issues"}else t.errorMessage=e instanceof Error?e.message:String(e);return t}var hn=_r;function Bn(e){return e.resourceType==="nativeToken"?`/fungibles/v1/${e.chainId}/${e.resourceType}/${e.slip44}`:`/fungibles/v1/${e.chainId}/${e.resourceType}/${e.address}`}function eo(e){return Bn(be(e))}function to(e){let t=new URLSearchParams,n="encodedCaip19"in e?eo(e.encodedCaip19):Bn(e.decodedCaip19);return e.includePrice&&t.append("includePrice","true"),e.includeFungibleDetails&&t.append("includeFungibleDetails","true"),[n,{params:t}]}async function ut(e){let t=await O.api().timeout(N({seconds:10})).get(...to(e)).then(n=>{if(X(n))return n.data;throw new Error(n.data?.message||n.data?.error||n.statusText,{cause:n.data?.code})}).catch(n=>{throw L.addBreadcrumb("tokens","getTokenDetails","error",{message:n.message,cause:n.cause,..."encodedCaip19"in e&&{caip19:e.encodedCaip19},..."decodedCaip19"in e&&{caip19:V(e.decodedCaip19)}}),L.captureError(n,"tokens"),n});try{return ot.parse(t)}catch(n){console.error(n);let o=hn(n);throw"encodedCaip19"in e&&typeof e.encodedCaip19=="string"?o.caip19=e.encodedCaip19:"decodedCaip19"in e&&(o.caip19=V(e.decodedCaip19)),L.addBreadcrumb("tokens","getTokenDetails.ParseError","error",o),n}}function no({caip19:e,includePrice:t}){let n=(0,pe.useMemo)(()=>typeof e=="string"?e:V(e),[e]),o=R(S),i=(0,pe.useMemo)(()=>{let u=o.find(f=>f.encodedCaip19===n);return u?{chainName:u.chainName,encodedCaip19:n,decodedCaip19:u.decodedCaip19,type:u.type,categories:[],price:u.price,symbol:u.symbol??"",name:u.name??"",decimals:u.decimals,legacyKey:u.legacyKey??n,spamStatus:u.spamStatus??"NOT_VERIFIED",logoUri:u.logoUri??null,extraMetadata:{description:"",id:"",isMutable:!0,...u.extraMetadata},createdDate:null}:null},[n,t]),a=ve({...t&&{refetchInterval:N({seconds:5})},queryKey:W.tokenDetails({caip19:n,includePrice:t}),queryFn:async()=>{let u=await ut(typeof e=="string"?{encodedCaip19:e,includeFungibleDetails:!0,includePrice:t}:{decodedCaip19:e,includeFungibleDetails:!0,includePrice:t});return Ot.parse(u)},...i&&{placeholderData:i}}),m=ae(J);return(0,pe.useEffect)(()=>{let u=a.data;u&&!a.isPlaceholderData&&t&&u.price&&m(f=>{let c=u.encodedCaip19,p=u.price;return Ve(f,{key:c,newPriceData:p})})},[a.data,a.isPlaceholderData,m,t]),a}var ro=no;l();d();var lt=(r=>(r.AF="AF",r.AX="AX",r.AL="AL",r.DZ="DZ",r.AS="AS",r.AD="AD",r.AO="AO",r.AI="AI",r.AQ="AQ",r.AG="AG",r.AR="AR",r.AM="AM",r.AW="AW",r.AU="AU",r.AT="AT",r.AZ="AZ",r.BS="BS",r.BH="BH",r.BD="BD",r.BB="BB",r.BY="BY",r.BE="BE",r.BZ="BZ",r.BJ="BJ",r.BM="BM",r.BT="BT",r.BO="BO",r.BQ="BQ",r.BA="BA",r.BW="BW",r.BV="BV",r.BR="BR",r.IO="IO",r.BN="BN",r.BG="BG",r.BF="BF",r.BI="BI",r.KH="KH",r.CM="CM",r.CA="CA",r.CV="CV",r.KY="KY",r.CF="CF",r.TD="TD",r.CL="CL",r.CX="CX",r.CC="CC",r.CO="CO",r.KM="KM",r.CK="CK",r.CR="CR",r.CI="CI",r.HR="HR",r.CU="CU",r.CW="CW",r.CY="CY",r.CZ="CZ",r.CD="CD",r.DK="DK",r.DJ="DJ",r.DM="DM",r.DO="DO",r.EC="EC",r.EG="EG",r.SV="SV",r.GQ="GQ",r.ER="ER",r.EE="EE",r.SZ="SZ",r.ET="ET",r.FK="FK",r.FO="FO",r.FJ="FJ",r.FI="FI",r.FR="FR",r.GF="GF",r.PF="PF",r.TF="TF",r.GA="GA",r.GE="GE",r.DE="DE",r.GH="GH",r.GI="GI",r.GR="GR",r.GL="GL",r.GD="GD",r.GP="GP",r.GU="GU",r.GT="GT",r.GG="GG",r.GN="GN",r.GW="GW",r.GY="GY",r.HT="HT",r.HM="HM",r.VA="VA",r.HN="HN",r.HK="HK",r.HU="HU",r.IS="IS",r.IN="IN",r.ID="ID",r.IQ="IQ",r.IE="IE",r.IR="IR",r.IM="IM",r.IL="IL",r.IT="IT",r.JM="JM",r.JP="JP",r.JE="JE",r.JO="JO",r.KZ="KZ",r.KE="KE",r.KI="KI",r.XK="XK",r.KW="KW",r.KG="KG",r.LA="LA",r.LV="LV",r.LB="LB",r.LS="LS",r.LR="LR",r.LY="LY",r.LI="LI",r.LT="LT",r.LU="LU",r.MO="MO",r.MG="MG",r.MW="MW",r.MY="MY",r.MV="MV",r.ML="ML",r.MT="MT",r.MH="MH",r.MQ="MQ",r.MR="MR",r.MU="MU",r.YT="YT",r.MX="MX",r.FM="FM",r.MD="MD",r.MC="MC",r.MN="MN",r.ME="ME",r.MS="MS",r.MA="MA",r.MZ="MZ",r.MM="MM",r.NA="NA",r.NR="NR",r.NP="NP",r.NL="NL",r.NC="NC",r.NZ="NZ",r.NI="NI",r.NE="NE",r.NG="NG",r.NU="NU",r.NF="NF",r.KP="KP",r.MP="MP",r.NO="NO",r.OM="OM",r.PK="PK",r.PW="PW",r.PA="PA",r.PG="PG",r.PY="PY",r.CN="CN",r.PE="PE",r.PH="PH",r.PN="PN",r.PL="PL",r.PT="PT",r.PR="PR",r.QA="QA",r.CG="CG",r.GM="GM",r.RE="RE",r.RO="RO",r.RU="RU",r.RW="RW",r.BL="BL",r.SH="SH",r.KN="KN",r.LC="LC",r.MF="MF",r.PM="PM",r.VC="VC",r.WS="WS",r.SM="SM",r.ST="ST",r.SA="SA",r.SN="SN",r.RS="RS",r.SC="SC",r.SL="SL",r.SG="SG",r.SX="SX",r.SK="SK",r.SI="SI",r.SB="SB",r.SO="SO",r.ZA="ZA",r.GS="GS",r.KR="KR",r.SS="SS",r.ES="ES",r.LK="LK",r.PS="PS",r.SD="SD",r.SR="SR",r.SJ="SJ",r.SE="SE",r.CH="CH",r.SY="SY",r.TW="TW",r.TJ="TJ",r.TH="TH",r.MK="MK",r.TL="TL",r.TG="TG",r.TK="TK",r.TO="TO",r.TT="TT",r.TN="TN",r.TR="TR",r.TM="TM",r.TC="TC",r.TV="TV",r.UG="UG",r.UA="UA",r.AE="AE",r.GB="GB",r.TZ="TZ",r.UM="UM",r.US="US",r.UY="UY",r.UZ="UZ",r.VU="VU",r.VE="VE",r.VN="VN",r.VG="VG",r.VI="VI",r.WF="WF",r.EH="EH",r.YE="YE",r.ZM="ZM",r.ZW="ZW",r))(lt||{});l();d();var Pn=(i=>(i.FAIL_SEVERE="FAIL_SEVERE",i.FAIL_HIGH="FAIL_HIGH",i.NO_ACTION="NO_ACTION",i.DATA_NOT_FOUND="DATA_NOT_FOUND",i))(Pn||{}),oo=s.object({action:s.nativeEnum(Pn),address:ft,expirationUnixtimeInSec:s.number().nullish().default(null)}),Tl=s.object({addressScreenResults:s.array(oo)}),bl=s.object({country:s.nativeEnum(lt)}),Cn=class extends Error{constructor(t){super(t),this.name="WalletScreenError"}};export{b as a,Rt as b,fo as c,R as d,ae as e,mo as f,I as g,we as h,G as i,W as j,Xr as k,Ie as l,jo as m,Qt as n,Bi as o,mr as p,bs as q,Q as r,De as s,rn as t,Ne as u,ne as v,z as w,$ as x,Ar as y,J as z,re as A,S as B,pn as C,gn as D,qr as E,En as F,yn as G,oe as H,Ke as I,vn as J,An as K,wn as L,ro as M,Tl as N,Cn as O};
//# sourceMappingURL=chunk-TMK4CY5E.js.map
